<!doctype html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>`
    <link rel="stylesheet" href="../../static/css/makingNewTimeTable.css" type="text/css">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/css/bootstrap.min.css" rel="stylesheet"
          integrity="sha384-rbsA2VBKQhggwzxH7pPCaAqO46MgnOM80zW1RWuH61DGLwZJEdK2Kadq2F9CUG65" crossorigin="anonymous">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.2.3/dist/js/bootstrap.bundle.min.js"
        integrity="sha384-kenU1KFdBIe4zVF0s0G1M5b4hcpxyD9F7jL+jjXkk+Q2h455rYXK/7HAuoJl+0I4"
        crossorigin="anonymous"></script>
</head>
<body>
<nav id="navbar-example2" class="navbar bg-light px-3 mb-3">
    <a class="navbar-brand" href="myTimeTable.demo">시간표 만들기</a>
    <ul class="nav nav-pills">
        <li class="nav-item">
            <a class="nav-link" href="#scrollspyHeading1">First</a>
        </li>
        <li class="nav-item">
            <a class="nav-link" href="#scrollspyHeading2">Second</a>
        </li>
        <li class="nav-item dropdown">
            <a class="nav-link dropdown-toggle" data-bs-toggle="dropdown" href="#" role="button" aria-expanded="false">Dropdown</a>
            <ul class="dropdown-menu">
                <li><a class="dropdown-item" href="#scrollspyHeading3">Third</a></li>
                <li><a class="dropdown-item" href="#scrollspyHeading4">Fourth</a></li>
                <li>
                    <hr class="dropdown-divider">
                </li>
                <li><a class="dropdown-item" href="#scrollspyHeading5">Fifth</a></li>
            </ul>
        </li>
    </ul>
</nav>
            <div id = "makingTimeTableBox" class="d-flex flex-row " data-bs-spy="scroll" data-bs-target="#navbar-example2" data-bs-root-margin="0px 0px -40%"
             data-bs-smooth-scroll="true" class="scrollspy-example bg-light p-3 rounded-2" tabindex="0">
             <div id = "makingTimeTableBox_InnerTimeTable" class="w-50">

                 <div class="btnWrap">
            <button onclick="add_group()">+그룹추가</button>
            </div>

            <!-- 박스 추가되는 영역 -->
            <div id="boxWrap">
            <div id="field">
                <!-- 초기 그룹 맨 처음 화면에 뜨는 초기 그룹은 두개임 -->
                <div class="original" data-group="1">
                        <div class="preset" style="display:none">
                            <input type="text" name="test1" value="" style="width:100px">
                            <input type="button" value="삭제" onclick="remove_item(this)">
                        </div>
                        <!-- 그룹 행 -->
                        <div class="groupRow">
                            <p>그룹1</p>
                            <input type="button" value="과목추가" onclick="add_item(this.parentNode.parentNode)">

                            <input type="button" value="그룹 삭제" onclick="remove_group(this.parentNode.parentNode)">
                        </div>
                    </div>
                    <div class="original" data-group="2">
                        <div class="preset" style="display:none">
                            <input type="text" name="test1" value="" style="width:100px">
                            <input type="button" value="삭제" onclick="remove_item(this)">
                        </div>
                        <div class="groupRow">
                            <p>그룹2</p>
                            <input type="button" value="과목추가" onclick="add_item(this.parentNode.parentNode)">
                            <input type="button" value="그룹 삭제" onclick="remove_group(this.parentNode.parentNode)">
                        </div>
                    </div>
                </div>
            </div>

             </div>
    <div id ="makingTimeTableBox_SearchBox" class= "w-50">
        <div id = "textSearchBox" >
            <div style="width: 60%">
             <input class="w-100" type="text" placeholder="검색어를 입력해주세요.">
            </div>
            <div >
                 <button id = "searchButton" type="button" class="btn ">검색</button>
            </div>
        </div>
        <div id="resultBox" class="p-1 w-100">
            아
        </div>
        <div class="p-1 w-100 d-flex justify-content-end">
            <button id = "searchButton" type="button" class="btn">시간표 검색하기</button>
        </div>

     </div>
</div>



    <script type="text/javascript">
        // 그룹의 번호를 재할당하는 함수
        function sync_group_numbers() {
            var groups = document.getElementsByClassName('original');
            var remainingGroups = groups.length;

            // 각 그룹에 순차적인 번호 할당
            for (var i = 0; i < groups.length; i++) {
                var group = groups[i];
                var groupNumber = i + 1;
                group.setAttribute('data-group', groupNumber);
                group.querySelector('p').innerText = "그룹" + groupNumber;
            }

            return remainingGroups;
        }

        // 그룹을 추가하는 함수
        function add_group() {
            var field = document.getElementById('field');
            var groupNumber = sync_group_numbers() + 1;        //그룹의 수 1증가

              if (groupNumber > 10) { // 최대 10개까지 추가 가능
                alert("그룹은 최대 10개까지 추가할 수 있습니다.");
                return;
            }

            // 새로운 그룹내의 과목 추가
            var div = document.createElement('div');
            div.className = 'original';
            div.setAttribute('data-group', groupNumber);
            div.innerHTML = `
                <div class="preset" style="display:none">
                    <input type="text" name="test1" value="" style="width:100px">
                    <input type="button" value="삭제" onclick="remove_item(this)">
                </div>
                <div class="groupRow">
                    <p>그룹${groupNumber}</p>
                    <input type="button" value="과목추가" onclick="add_item(this.parentNode.parentNode)">
                    <input type="button" value="그룹 삭제" onclick="remove_group(this.parentNode.parentNode)">
                </div>
            `;
            field.appendChild(div);
        }


        //과목 추가 함수
        function add_item(parentNode) {
            var div = document.createElement('div');
            var preset = parentNode.querySelector('.preset');
            div.innerHTML = preset.innerHTML;
            parentNode.appendChild(div);
        }

        //그룹 삭제 함수
        function remove_group(group) {
            var remainingGroups = sync_group_numbers();

             // 그룹의 수가 2개 이하인 경우 삭제 불가능함
            if (remainingGroups <= 2) {
                alert("시간표를 만들기 위해 2개 이상의 그룹이 필요합니다.");
            } else {
                var groupNumber = parseInt(group.getAttribute('data-group'));
                group.parentNode.removeChild(group);

                // 그룹 삭제 후 남은 그룹의 번호 재할당
                sync_group_numbers();
            }
        }

        //과목 삭제 함수
        function remove_item(obj) {
            obj.parentNode.parentNode.removeChild(obj.parentNode);
        }

    </script>
</body>
</html>